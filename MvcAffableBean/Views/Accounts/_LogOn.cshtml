
@model MvcAffableBean.Models.LogOnModel
@{
    ViewBag.Title = "Sign In";
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Mobile Number</title>
    <script src="~/Scripts/jquery-1.10.2.js"></script>
    <script src="~/Scripts/bootstrap.js"></script>
    <link href="~/Content/bootstrap.css" rel="stylesheet" />
</head>
<body>
    @Html.ValidationSummary(true, "Login was unsuccessful. Please correct the errors and try again.")
    <div class="row">
        <div class="panel-heading">
            
        </div>
        @*@using (Html.BeginForm("LogOn", "Accounts",FormMethod.Post))
            {*@
        <div class="col-md-6 col-sm-12 col-lg-6 col-md-offset-3">
            <div class="panel panel-primary">

                <div class="panel-body">
                    <div class="form-group">
                    </div>
                    <form name="myform">                       
                        <div class="form-group">
                            <label for="phone">Login with your mobile *</label>
                            <input type="text" id="username" name="phone" class="form-control">
                            <span id="error_phone" class="text-danger"></span>
                        </div>
                        <div class="form-group">
                            <label for="disc">Password *</label>
                            <input id="password" type="password" maxlength="7" name="password" class="form-control" data-validation="required" />
                            <span id="error_password" class="text-danger"></span>
                        </div>
                        <button id="btnLogin" type="button" value="submit" class="modal-link btn btn-success">Sign In</button>
                        <button id="cancel" value="Review Order" class="btn btn-primary center">Cancel</button>
                        

                        <div class="center ap-top10">
                            <a id="dlgLinkForgot" class="inv-link">Forgot Password?</a>
                        </div>
                    </form>
                </div>

            </div>
        </div>
        // }
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $("#username").text('');
            $("#password").text('');
            var mobiledetail = '@ViewData["MobileDetail"]';
           // alert("Heloo Login" + mobiledetail[0] + mobiledetail[1]);
            console.log(mobiledetail);
            $("#username").val(mobiledetail);
        });
        $flag = 1;
        $("#username").focusout(function () {
            $pho = $("#username").val();
            if ($(this).val() == '') {
                $(this).css("border-color", "#FF0000");
                $('#btnLogin').attr('disabled', true);
                $("#error_phone").text("Please enter your Phone Number *");
            }
            else if ($pho.length != 10) {
                $(this).css("border-color", "#FF0000");
                $('#btnLogin').attr('disabled', true);
                $("#error_phone").text("Lenght of Phone Number Should Be Ten *");
            }
            else if (!$.isNumeric($pho)) {
                $(this).css("border-color", "#FF0000");
                $('#submit').attr('disabled', true);
                $("#error_phone").text("Phone Number Should Be Numeric *");
            }
            else {
                $(this).css({ "border-color": "#2eb82e" });
                $('#btnLogin').attr('disabled', false);
                $("#error_phone").text("");
            }
        });
        $("#password").focusout(function () {
            if ($(this).val() == '') {
                $(this).css("border-color", "#FF0000");
                $('#btnLogin').attr('disabled', true);
                $("#error_password").text("Please enter your Password");
            }
            else {
                $(this).css({ "border-color": "#2eb82e" });
                $('#btnLogin').attr('disabled', false);
                $("#error_password").text("");
            }
        });
        $("#btnLogin").click(function () {
            //$('#modal-container').modal('hide');
            if ($("#username").val() == '') {
                $("#username").css("border-color", "#FF0000");
                $('#btnLogin').attr('disabled', true);
                $("#error_phone").text("Please enter your Mobile Number Number *");
            }
           else if ($("#password").val() == '') {
                $("#password").css("border-color", "#FF0000");
                $('#btnLogin').attr('disabled', true);
                $("#error_password").text("Please enter your Password");
            }
            else {
                var model = {
                    UserName: $("#username").val(),
                    Password:$("#password").val()
                };-

                $.ajax({
                    type: "POST",
                    url: "/Accounts/LogOn",
                    contentType: "application/json; charset=utf-8",
                    data: "{ model:"+JSON.stringify(model)+"}",
                    success: function (result) {
                        console.log(result);
                        $("#exampleModalLong").hremoveClass("modal fade").hide(); 
                       //$("#exampleModalLong").removeClass("modal fade").hide();
                    },
                    error: function (xhr, status, error) {
                        console.log("Ajax Error");
                        // $("#dataDiv").html("Result: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
                        //alert("error");
                    }
                });
            }
        });
    </script>
</body>
</html>


